
# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ö–æ–¥–∞ "–ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞"



–†–µ—à–µ–Ω–∏–µ –¥–ª—è –∏–≥—Ä—ã –≤ —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞–º–∏ –≤ –∏–≥—Ä–µ "–ö–∞–º–µ–Ω—å-–ù–æ–∂–Ω–∏—Ü—ã-–ë—É–º–∞–≥–∞" –¥–æ —Ç—Ä–µ—Ö –ø–æ–±–µ–¥. –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–Ω—Å–∞–º–±–ª–µ–≤–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (**Stacking**) –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –µ–≥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ö–æ–¥–∞.

## üìã –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **Stacking Classifier**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–∞-–º–æ–¥–µ–ª–∏, –æ–±—ä–µ–¥–∏–Ω—è—é—â–µ–π –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:
  - CatBoost
  - Random Forest
  - Support Vector Machine (SVM)
  - K-Nearest Neighbors (KNN)
  - Logistic Regression
  - DummyClassifier
- **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å**: –ò–º–µ–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –æ–±—É—á–µ–Ω–∏—è –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ–Ω—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞.
- **–û—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏**: –ú–æ–¥–µ–ª–∏ –æ–±—É—á–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞—É–Ω–¥–∞ –∏–≥—Ä—ã. 

## üìä –ó–∞—á–µ–º —Ç–∞–∫ –º–Ω–æ–≥–æ –º–æ–¥–µ–ª–µ–π?
–í —Ö–æ–¥–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π —è –∑–∞–º–µ—Ç–∏–ª, —á—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞ —Å–∏–ª—å–Ω–æ –º–µ–Ω—è–µ—Ç—Å—è –æ—Ç —Ö–æ–¥–∞ –∫ —Ö–æ–¥—É. –û–¥–Ω–æ–π –º–æ–¥–µ–ª–∏ —Å–æ —Å–∫–æ–ª—å–∑—è—â–∏–º –æ–∫–Ω–æ–º –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –±—ã –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –ø–æ–¥—Å—Ç—Ä–∞–∏—Ç—å—Å—è –ø–æ–¥ —ç—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–∞–∂–¥–æ–º —Ä–∞—É–Ω–¥–µ.

–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ª—É—á—à–µ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ—Ç–∏–≤ –±–æ—Ç–æ–≤ –∏–ª–∏ –ª—é–¥–µ–π, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –∏–≥—Ä–∞—é—Ç—Å—è —Å–æ—Ç–Ω–∏ –º–∞—Ç—á–µ–π. –≠—Ç–æ –¥–∞–µ—Ç –∏–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑—É—á–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –æ–ø–ø–æ–Ω–µ–Ω—Ç–∞. –í–µ–¥—å –∫ —É—Å–ª–æ–≤–Ω–æ 100-–º—É —Ä–∞—É–Ω–¥—É –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω—ã–º –∏ –ø–æ—á—Ç–∏ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã—Ö —Ö–æ–¥–æ–≤ –¥–æ 10-–≥–æ —Ä–∞—É–Ω–¥–∞.




## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
rps-ml-bot/
‚îú‚îÄ‚îÄ data/                 # –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (CSV —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∏–≥—Ä)
‚îú‚îÄ‚îÄ models/               # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (.joblib)
‚îú‚îÄ‚îÄ src/                  # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ config.py         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ features.py       # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (Feature Engineering)
‚îÇ   ‚îú‚îÄ‚îÄ model_factory.py  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Å–±–æ—Ä–∫–∞ ML-–º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ trainer.py        # –õ–æ–≥–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è (Training pipeline)
‚îÇ   ‚îî‚îÄ‚îÄ predictor.py      # –õ–æ–≥–∏–∫–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ (Prediction pipeline)
‚îú‚îÄ‚îÄ main.py               # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ requirements.txt      # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ README.md             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

**data/games.csv** ‚Äî –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏–≥—Ä (–¥–ª—è –æ–±—É—á–µ–Ω–∏—è –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤—Ä–∞–≥–∞).

**data/first_games_only.csv** ‚Äî —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ –∏–≥—Ä –ø—Ä–æ—Ç–∏–≤ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞ (–¥–ª—è –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏).

**models/basic.joblib** - –±–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å –ø—Ä–æ—Ç–∏–≤ –≤—Å–µ—Ö –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–æ–≤

**models/{–∏–º—è –≤—Ä–∞–≥–∞}.joblib** - –º–æ–¥–µ–ª—å –ø—Ä–æ—Ç–∏–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤—Ä–∞–≥–∞


## üìà –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π 

–ú–æ–∂–Ω–æ –æ–±—É—á–∏—Ç—å "–±–∞–∑–æ–≤—É—é" –º–æ–¥–µ–ª—å –∏–ª–∏ –º–æ–¥–µ–ª—å –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞ —á–µ—Ä–µ–∑ RPSTrainer. –ü—Ä–∏–º–µ—Ä –≤ main.py:

```python 
from src.trainer import RPSTrainer

# –û–±—É—á–µ–Ω–∏–µ –æ–±—â–µ–π –º–æ–¥–µ–ª–∏
trainer = RPSTrainer.create_noname_predictor()
trainer.train()

# –û–±—É—á–µ–Ω–∏–µ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤—Ä–∞–≥–∞ "enemy_name"
trainer = RPSTrainer.create_current_enemy_predictor("enemy_name")
trainer.train()
```

## –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ö–æ–¥–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª–∞—Å—Å RPSPredictor –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ö–æ–¥–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

```python
from src.predictor import RPSPredictor

# –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—â–µ—Ç 'basic.joblib')
predictor = RPSPredictor(enemy_name="basic")

# –ò—Å—Ç–æ—Ä–∏—è —Ç–µ–∫—É—â–µ–π –∏–≥—Ä—ã (—Å—Ç—Ä–æ–∫–∞: –º–æ–π —Ö–æ–¥, —Ö–æ–¥ –≤—Ä–∞–≥–∞, –º–æ–π —Ö–æ–¥...)
# –ü—Ä–∏–º–µ—Ä: –Ø —Å—ã–≥—Ä–∞–ª –∫–∞–º–µ–Ω—å (r), –æ–Ω –±—É–º–∞–≥—É (p), —è —Å—ã–≥—Ä–∞–ª –∫–∞–º–µ–Ω—å (r), –æ–Ω –Ω–æ–∂–Ω–∏—Ü—ã (s)
history = "rprs" 

next_move = predictor.predict(history)
print(f"–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ö–æ–¥: {next_move}")
```

## üß† –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

–°–±–æ—Ä –∏—Å—Ç–æ—Ä–∏–∏: –°—Ç—Ä–æ–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, rprs) –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ Pandas DataFrame.

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–∏—á–µ–π: –°–æ–∑–¥–∞—é—Ç—Å—è —Å—Ç–æ–ª–±—Ü—ã —Å –ø—Ä–æ—à–ª—ã–º–∏ —Ö–æ–¥–∞–º–∏ (my_move_1, enemy_move_1 –∏ —Ç.–¥.).

–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏: –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞—É–Ω–¥–∞ –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –º–æ–¥–µ–ª—å

**–ê–Ω—Å–∞–º–±–ª—å (Stacking):**

–ë–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ (RF, KNN, SVM, CatBoost) –≤—ã–¥–∞—é—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è r, p, s.

–ú–µ—Ç–∞-–º–æ–¥–µ–ª—å (LogisticRegression) –≤–∑–≤–µ—à–∏–≤–∞–µ—Ç –∏—Ö –≥–æ–ª–æ—Å–∞ –∏ –≤—ã–¥–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π.

–í—ã–±–æ—Ä –∫–æ–Ω—Ç—Ä-—Ö–æ–¥–∞: –ù–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –º–æ–¥–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ñ–∏–≥—É—Ä—É –∫–æ—Ç–æ—Ä–∞—è —Å –±–æ–ª—å—à–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –ø–æ–±–µ–¥–∏—Ç –∏ —Å –º–∞–ª–µ–Ω—å–∫–æ–π –ø—Ä–æ–∏–≥—Ä–∞–µ—Ç.


